<!DOCTYPE html>
<html lang="en" data-bs-theme="light">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../img/favicon.ico">
        <title>Example Analyses - PASTa</title>
        <link href="../css/bootstrap.min.css" rel="stylesheet">
        <link href="../css/fontawesome.min.css" rel="stylesheet">
        <link href="../css/brands.min.css" rel="stylesheet">
        <link href="../css/solid.min.css" rel="stylesheet">
        <link href="../css/v4-font-face.min.css" rel="stylesheet">
        <link href="../css/base.css" rel="stylesheet">
        <link id="hljs-light" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" >
        <link id="hljs-dark" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github-dark.min.css" disabled>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script>hljs.highlightAll();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="..">PASTa</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbar-collapse" aria-controls="navbar-collapse" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="nav-item">
                                <a href=".." class="nav-link">Home</a>
                            </li>
                            <li class="nav-item">
                                <a href="../gettingstarted/" class="nav-link">Getting Started</a>
                            </li>
                            <li class="nav-item dropdown">
                                <a href="#" class="nav-link dropdown-toggle" role="button" data-bs-toggle="dropdown"  aria-expanded="false">User Guide</a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../userguide/userguide/" class="dropdown-item">User Guide</a>
</li>
                                    
<li>
    <a href="../userguide/datapreparation/" class="dropdown-item">Data Preparation</a>
</li>
                                    
<li>
    <a href="../userguide/signalprocessing/" class="dropdown-item">Signal Processing</a>
</li>
                                    
<li>
    <a href="../userguide/transientanalysis/" class="dropdown-item">Transient Analysis</a>
</li>
                                    
<li>
    <a href="../userguide/plotdata/" class="dropdown-item">Data Visualization</a>
</li>
                                </ul>
                            </li>
                            <li class="nav-item">
                                <a href="../functiondocumentation/" class="nav-link">Function Documentation</a>
                            </li>
                            <li class="nav-item">
                                <a href="./" class="nav-link active" aria-current="page">Example Analyses</a>
                            </li>
                            <li class="nav-item dropdown">
                                <a href="#" class="nav-link dropdown-toggle" role="button" data-bs-toggle="dropdown"  aria-expanded="false">About</a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../about/pastateam/" class="dropdown-item">PASTa Team</a>
</li>
                                    
<li>
    <a href="../about/releasenotes/" class="dropdown-item">Version Release Notes</a>
</li>
                                    
<li>
    <a href="../about/citepasta/" class="dropdown-item">How to Cite PASTa</a>
</li>
                                    
<li>
    <a href="../about/license/" class="dropdown-item">License</a>
</li>
                                    
<li>
    <a href="../contactus/" class="dropdown-item">Contact Us</a>
</li>
                                    
<li>
    <a href="../about/references/" class="dropdown-item">References</a>
</li>
                                </ul>
                            </li>
                            <li class="nav-item">
                                <a href="../learningresources/" class="nav-link">Learning Resources</a>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ms-md-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-bs-toggle="modal" data-bs-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li class="nav-item">
                                <a rel="prev" href="../functiondocumentation/" class="nav-link">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li class="nav-item">
                                <a rel="next" href="../about/pastateam/" class="nav-link">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-bs-toggle="collapse" data-bs-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-body-tertiary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-bs-level="1"><a href="#injection-transients" class="nav-link">Injection Transients</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-bs-level="2"><a href="#data-summary" class="nav-link">Data Summary</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#data-preparation" class="nav-link">Data Preparation</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#signal-processing" class="nav-link">Signal Processing</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#transient-detection" class="nav-link">Transient Detection</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<p>To help users get started with the PASTa Protocol, here some example analyses are included with raw data to walk users through each step of the process.</p>
<h1 id="injection-transients">Injection Transients</h1>
<p>This example is of whole session transient analysis to determine changes in dopaminergic cell body GCaMP6f transients following morphine injection. The example analysis script is located in the PASTa repository under 'Example Analyses\main_ExampleAnalysis_Transients.m'.</p>
<h2 id="data-summary">Data Summary</h2>
<p>Example data are provided from two subjects. Each subject has two fiber photometry sessions conducted on consecutive days: saline and morphine (10mg/kg). Each session consists of a fifteen minute baseline, an i.p. injection, and a 60 minute post-injection recording period. Fiber photometry data were recorded using Tucker Davis Technologies RZ5 processor, with a 465nm excitation wavelength ('signal') and a 405nm isosbestic control wavelength ('background'). Injection start and end time points are marked by epocs sent through Med Associates equipment and stored by Synapse as time stamps. </p>
<p>Data are available for download from <a href="https://uofi.box.com/s/pqpa8286yi6oia1ocjts7qytb1wetgpv">Box</a> under <em>Example Analyses</em>. The subfolder <em>Injection Transients</em> is prepared for the analysis, containing the file and subject keys, as well as folders created for extracted data, analysis, and figure outputs. Raw data blocks collected via Synapse (Tucker Davis Technologies) are nested in the Raw Data folder.</p>
<p><strong>NOTE FOR MAC USERS:</strong> A Mac compatible version of the file key is included in the <em>Example Analyses</em> folder. In your main analysis script, make sure to update the file name to <em>'FileKey_ExampleAnalysis_MorphineTransients_MAC.csv'</em>.</p>
<p>If you have any questions or run into problems accessing the files, please feel free to <a href="https://rdonka.github.io/PASTaUserGuide/contactus/">contact us</a>.</p>
<h2 id="data-preparation">Data Preparation</h2>
<p>The first section of the script sets up paths and analysis key inputs. To enable users to switch computers easily, paths are created without the computer and user specific portion. The computer user specific portion of the path is input to the variable computeruserpath and appended to subsequently needed paths. To access files and functions, paths need to be added to MATLAB via the <em>addpath</em> function. <em>genpath</em> is used within addpath to ensure folders and subfolders at the input path are added. Finally, the names of created Subject and File Keys are added to variables <em>subjectkeyname</em> and <em>filekeyname</em>. These keys contain the session specific and subject specific information needed to load the data and analyze the results. For details on keys, see the user guide section on <a href="https://rdonka.github.io/PASTaUserGuide/userguide/datapreparation/">Data Preparation</a>.</p>
<p>The keys are loaded using the function <em>loadKeys</em> to join the subject specific data to the session specific information contained in the file key. Paths to raw data blocks and extracted output locations are added to string arrays, which are input to the function <em>extractTDTdata</em>. <em>extractTDTdata</em> first extracts the raw data for each file into a data structure, then saves the MATLAB data structure to extracted output location. Extracted structures for each file are then loaded by the function <em>loadKeydata</em>. </p>
<p>After data are loaded, excess samples before the start of the program and after the end of the post-injection period are cropped from the streams. First, session  start and end indices are prepared for each file. These indices are input to the function <em>cropFPdata</em>, which removes the excess samples from the signal and background streams, and adjusts the injection and session start time stamp epocs.</p>
<h2 id="signal-processing">Signal Processing</h2>
<p>To control for motion artifacts and photobleaching, the 405 nm channel (baq) is subtracted from the 465 nm channel (sig) with the function <em>subtractFPdata</em>. First, this function scales the background stream to the signal stream. After scaling, the background is subtracted from the signal in the time domain, and filtered with a Butterworth bandpass filter to remove the DC offset as well as high frequency noise (frequencies outside the range of biological interest). The scaling factor (<em>'baqscalingfactor'</em>), subtracted signal (<em>'sigsub'</em>), filtered signal (<em>'sigfilt'</em>) are added to the data structure.</p>
<p>Raw, subtracted, and filtered streams for the whole session are visualized and saved to the output folder <em>'Figures'</em>.</p>
<p><img alt="png" src="../img/exampleanalyses_1_SessionTraces_427_Morphine.png" /></p>
<p>Additionally, frequency magnitude plots of the FFTs of the raw, scaled, subtracted, and filtered streams are generated and saved to the <em>'Figures'</em> folder.</p>
<p><img alt="png" src="../img/exampleanalyses_2_SessionFFTs_427_Morphine.png" /></p>
<p>After subtraction, the filtered signal is normalized. To normalize to the entire session, the function <em>normSession</em> is called, outputting the z scored signal streams to <em>'sigfiltz_normsession'</em>. To normalize to pre injection baseline, the function normBaseline is called, which uses the pre-injection period to normalize the entire session, outputting the z scored streams to <em>'sigfiltz_normsession'</em>. </p>
<p>Finally, a for loop is used to create streams with the injection time period removed. For details on the signal processing functions and methods, see the user guide section on <a href="https://rdonka.github.io/PASTaUserGuide/userguide/signalprocessing/">Signal Processing</a>.</p>
<h2 id="transient-detection">Transient Detection</h2>
<p>To identify transient events, the <em>findSessionTransients</em> functions are used. These functions detect relevant transients in the normalized data stream based on an amplitude inclusiong criterion (eg, 3SD amplitude) relative to baseline. Multiple baseline options exist - see function documentation for <em>findSessionTransients_blmean</em>, <em>findSessionTransients_blmin</em>, and <em>findSessionTransients_localmin</em> for more specific details. </p>
<p>After detection, transients are quantified by frequency, amplitude, half height rise time, half height fall time, half height width, and half height AUC. After detection and quantification, transients are binned into 5 minute increments. To do so, the number of samples per bin is identified and added to the data structure. The function <em>binSessionTransients</em> identifies and adds the bin of each transient event to the <em>transientquantificiation</em> table. Individual bins with identified transients are plotted and figures are saved to the folder.</p>
<p><img alt="png" src="../img/exampleanalyses_3_SessionBins_blmin_427_Morphine.png" /></p>
<p>To export the transient events for statistical analysis, the table for each file is appended into the table alltransients which is output as a csv to the location specified by analysispath. Relevant experimental variables (subject ID, treatment number, and injection type) are appended to the table.</p></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script src="../js/bootstrap.bundle.min.js"></script>
        <script>
            var base_url = "..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../js/base.js"></script>
        <script src="../search/main.js"></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <p>From here you can search these documents. Enter your search terms below.</p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results" data-no-results-text="No results found"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
