<!DOCTYPE html>
<html lang="en" data-bs-theme="light">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../img/favicon.ico">
        <title>Example Analyses - PASTa</title>
        <link href="../css/bootstrap.min.css" rel="stylesheet">
        <link href="../css/fontawesome.min.css" rel="stylesheet">
        <link href="../css/brands.min.css" rel="stylesheet">
        <link href="../css/solid.min.css" rel="stylesheet">
        <link href="../css/v4-font-face.min.css" rel="stylesheet">
        <link href="../css/base.css" rel="stylesheet">
        <link id="hljs-light" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" >
        <link id="hljs-dark" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github-dark.min.css" disabled>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script>hljs.highlightAll();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="..">PASTa</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbar-collapse" aria-controls="navbar-collapse" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="nav-item">
                                <a href=".." class="nav-link">Home</a>
                            </li>
                            <li class="nav-item">
                                <a href="../gettingstarted/" class="nav-link">Getting Started</a>
                            </li>
                            <li class="nav-item dropdown">
                                <a href="#" class="nav-link dropdown-toggle" role="button" data-bs-toggle="dropdown"  aria-expanded="false">User Guide</a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../userguide/userguide/" class="dropdown-item">User Guide</a>
</li>
                                    
<li>
    <a href="../userguide/datapreparation/" class="dropdown-item">Data Preparation</a>
</li>
                                    
<li>
    <a href="../userguide/signalprocessing/" class="dropdown-item">Signal Processing</a>
</li>
                                    
<li>
    <a href="../userguide/transientanalysis/" class="dropdown-item">Transient Analysis</a>
</li>
                                </ul>
                            </li>
                            <li class="nav-item">
                                <a href="./" class="nav-link active" aria-current="page">Example Analyses</a>
                            </li>
                            <li class="nav-item">
                                <a href="../functiondocumentation/" class="nav-link">Function Documentation</a>
                            </li>
                            <li class="nav-item dropdown">
                                <a href="#" class="nav-link dropdown-toggle" role="button" data-bs-toggle="dropdown"  aria-expanded="false">About</a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../about/pastateam/" class="dropdown-item">PASTa Team</a>
</li>
                                    
<li>
    <a href="../about/releasenotes/" class="dropdown-item">Version Release Notes</a>
</li>
                                    
<li>
    <a href="../about/citepasta/" class="dropdown-item">How to Cite PASTa</a>
</li>
                                    
<li>
    <a href="../about/license/" class="dropdown-item">License</a>
</li>
                                    
<li>
    <a href="../contactus/" class="dropdown-item">Contact Us</a>
</li>
                                    
<li>
    <a href="../about/references/" class="dropdown-item">References</a>
</li>
                                </ul>
                            </li>
                            <li class="nav-item">
                                <a href="../learningresources/" class="nav-link">Resources</a>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ms-md-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-bs-toggle="modal" data-bs-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li class="nav-item">
                                <a rel="prev" href="../userguide/transientanalysis/" class="nav-link">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li class="nav-item">
                                <a rel="next" href="../functiondocumentation/" class="nav-link">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-bs-toggle="collapse" data-bs-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-body-tertiary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-bs-level="1"><a href="#example-analysis-injection-transients" class="nav-link">Example Analysis: Injection Transients</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-bs-level="2"><a href="#methods" class="nav-link">Methods</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#analysis-script" class="nav-link">Analysis Script</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#results" class="nav-link">Results</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#conclusion" class="nav-link">Conclusion</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<h1 id="example-analysis-injection-transients">Example Analysis: Injection Transients</h1>
<p>PASTa includes an example analysis with fiber photometry recordings to help users get comfortable with the workflow and observe the effects of each stage of processing on the signal. The analysis script is available on GitHub, and the data are freely accessible on (Box)[https://uofi.app.box.com/s/pqpa8286yi6oia1ocjts7qytb1wetgpv/folder/256973884209] at <a href="https://uofi.app.box.com/s/pqpa8286yi6oia1ocjts7qytb1wetgpv/folder/256973884209">https://uofi.app.box.com/s/pqpa8286yi6oia1ocjts7qytb1wetgpv/folder/256973884209</a> under <em>Example Analyses</em>. The subfolder <em>Injection Transients</em> is prepared for the analysis, containing the file and subject keys, as well as folders created for extracted data, analysis, and figure outputs. Raw data blocks collected via Synapse (Tucker Davis Technologies) are nested in the Raw Data folder.The completed analysis output files including extracted data structures, transient quantification, and plots are also available for download.</p>
<p>If you have any questions or run into problems accessing the files, please feel free to <a href="https://rdonka.github.io/PASTaUserGuide/contactus/">contact us</a>.</p>
<h2 id="methods">Methods</h2>
<h3 id="overview">Overview</h3>
<p>Example data are provided from two subjects. Each subject has two fiber photometry sessions conducted on consecutive days: saline and morphine (10mg/kg). Each session consists of a fifteen minute baseline, an intraperitoneal injection, and a 60 minute post-injection recording period. Fiber photometry data were recorded using Tucker Davis Technologies RZ10X processor, with a 465nm excitation wavelength (signal; <em>'sig'</em>) and a 405nm isosbestic control wavelength (background, <em>'baq'</em>). Injection start and end time points are marked by epochs (<em>'injt'</em>) sent through Med Associates equipment and stored by Synapse as time stamps. </p>
<h3 id="animals">Animals</h3>
<p>Adult male and female Long Evans rats (n = 2) expressing Cre recombinase under the control of the tyrosine hydroxylase promoter (TH:Cre+; [34]) were paired housed within a temperature and humidity-controlled vivarium on a 12:12 hour light-dark cycle with lights on at 7:00 am and maintained on ad libitum food and water for the direction of all experiments. All procedures were conducted in accordance with guidelines set by the National Institutes for Health Guide for the Care and Use of Laboratory Animals and approved by the Animal Care Committee of the University of Illinois Chicago. Recordings were conducted during the light portion of the cycle.</p>
<h3 id="stereotaxic-surgery-procedures">Stereotaxic Surgery Procedures</h3>
<p>Rats were anesthetized via isoflurane (induction: 4%; maintenance: ~2%) and injected with meloxicam (1mg/kg, subcutaneous) prior to the start of stereotaxic surgery. To isolate and record from dopamine neuronal cell bodies, AAV1.hSyn.Flex.GCaMP6f.WPRE.SV40 was targeted to the VTA (Anterior/Posterior (AP): - 5.40mm, Medial/Lateral (ML): +0.70mm, Dorsal/Ventral (DV): -8.15mm, relative to Bregma) of TH:Cre+ rats. Viral injections were performed with a volume of 1μL at a rate of 0.1μL/minute with a blunt 30-gauge injection needle mated to a Hamilton syringe via PEEK tubing and connected to a syringe pump. A 5 minute post-injection period followed to ensure complete virus diffusion. An optic fiber (flat 400-μm core, 0.48 NA, Doric Lenses, Inc.) was implanted above the injection site and secured to three implanted skull screws via metabond and dental cement.</p>
<h3 id="fiber-photometry-data-collection">Fiber Photometry Data Collection</h3>
<p>Fiber photometry recordings were performed as in Konanur et al 2020, Hsu et al 2020, and Konanur et al 2024, and Loh et al 2025 [35-38]. Data were collected using data acquisition systems from Tucker Davis Technologies (RZ10X). Implanted fiber optic cannulae of subjects were mated to a patch cord, which was connected through a commutator to a filter cube (FMC4, Doric Lenses). Emitted fluorescence was collected by an external photoreceiver (Visible Femtowatt Photoreceiver Model 2151; Newport) and passed to the data acquisition system for live visualization and recording. LEDs administered 465nm and 405nm wavelengths at a total power output of 30μW. Light was sinusoidally modulated at 211 and 531 Hz respectively. Lock in amplification was used to demodulate the fluorescence by emission wavelength.</p>
<p>Fiber photometry recording sessions were conducted on consecutive days, with the first session consisting of a control saline treatment (1mL/kg, intraperitoneal (i.p.); figure panel A) and the second session consisting of acute morphine treatment (10mg/kg morphine sulfate, i.p.; figure panel B). Each test session consisted of a 15 minute pre-injection baseline, followed by a 60-minute post-injection recording period. Signal processing was performed with PASTa protocol defaults. Subtracted and filtered data streams were normalized to z-score based on the pre-injection baseline period. Transient events were detected at a threshold of 2.6 SDs using PASTa protocol default parameters.</p>
<h2 id="analysis-script">Analysis Script</h2>
<p>The full analysis script is available via the (PASTa GitHub)[https://github.com/rdonka/PASTa] under the subfolder <em>"Example Analyses"</em>. Download the file "main_ExampleAnalysis_InjectionTransients.m".</p>
<h3 id="data-preparation">Data Preparation</h3>
<p>The first section of the script sets up paths and analysis key inputs. To enable users to switch computers easily, paths are created without the computer and user specific portion. The computer user specific root directory of the path is input to the variable <em>rootdirectory</em> and appended to subsequently needed paths. </p>
<p>For users accessing PASTa via cloning the repository, to access files and functions, paths need to be added to MATLAB via the <em>addpath</em> function. <em>genpath</em> is used within addpath to ensure folders and subfolders at the input path are added. Finally, the names of created Subject and File Keys are added to variables <em>subjectkeyname</em> and <em>filekeyname</em>. These keys contain the session specific and subject specific information needed to load the data and analyze the results. For details on keys, see the user guide section on <a href="https://rdonka.github.io/PASTaUserGuide/userguide/datapreparation/">Data Preparation</a>.</p>
<p>The keys are loaded using the function <em>createExperimentKey</em> to join the subject specific data to the session specific information contained in the file key. Paths to raw data blocks and extracted output locations are added to string arrays, which are input to the function <em>extractTDTdata</em>. <em>extractTDTdata</em> first extracts the raw data for each file into a data structure, trims the first 5 seconds of the recording, and then saves the MATLAB data structure to extracted output location. Extracted structures for each file are then loaded by the function <em>loadKeydata</em>. </p>
<p>After data are loaded, excess samples before the start of the program and after the end of the post-injection period are cropped from the streams. First, session  start and end indices are prepared for each file. These indices are input to the function <em>cropFPdata</em>, which removes the excess samples from the signal and background streams, and adjusts the injection and session start time stamp epocs.</p>
<h3 id="signal-processing">Signal Processing</h3>
<p>To control for motion artifacts and photobleaching, the 405 nm channel (<em>'baq'</em>) is subtracted from the 465 nm channel (<em>'sig'</em>) with the function <em>subtractFPdata</em>. The example analysis script uses the default <em>'frequency'</em> scaling method (see the user guide section (Signal Processing)[https://rdonka.github.io/PASTaUserGuide/userguide/signalprocessing/] for full details and alternative scaling options). </p>
<p>First, <em>subtractFPdata</em> scales the background stream to the signal stream. After scaling, the background is subtracted from the signal in the time domain, and filtered with a Butterworth bandpass filter to remove the DC offset as well as high frequency noise (frequencies outside the range of biological interest). The scaling factor (<em>'baqscalingfactor'</em>), subtracted signal (<em>'sigsub'</em>), filtered signal (<em>'sigfilt'</em>) are added to the data structure.</p>
<p>Raw, subtracted, and filtered streams for the whole session are visualized and saved to the output folder <em>'Figures'</em>.</p>
<p><img alt="png" src="../img/exampleanalyses_1_SessionTraces_1_Saline.png" /></p>
<p>Additionally, frequency magnitude plots of the FFTs of the raw, scaled, subtracted, and filtered streams are generated and saved to the <em>'Figures'</em> folder.</p>
<p><img alt="png" src="../img/exampleanalyses_2_SessionFFTs_2_Saline.png" /></p>
<h3 id="normalization">Normalization</h3>
<p>After subtraction, the filtered signal is normalized. To normalize to the entire session, the function <em>normSession</em> is called, outputting the z scored signal streams to <em>'sigfiltz_normsession'</em>. To normalize to pre injection baseline, the function <em>normBaseline</em> is called, which uses the pre-injection period to normalize the entire session, outputting the z scored streams to <em>'sigfiltz_normbaseline'</em>. </p>
<p>Finally, a for loop is used to create streams with the injection time period removed. For details on the signal processing functions and methods, see the user guide section on <a href="https://rdonka.github.io/PASTaUserGuide/userguide/signalprocessing/">Signal Processing</a>.</p>
<p><img alt="png" src="../img/exampleanalyses_3_Normalization_2_Saline.png" /></p>
<h3 id="transient-detection">Transient Detection</h3>
<p>To identify transient events, the <em>findTransients</em> function is used. This function detects relevant transients in the normalized data stream based on an amplitude inclusion criterion (eg, 2.6 SD) relative to the pre-event baseline. The example analysis uses the default pre-event baseline type (baseline window mean; <em>'blmean'</em>) and baseline window parameters. See the user guide section (Transient Analysis)[https://rdonka.github.io/PASTaUserGuide/userguide/transientanalysis/] for more details and optional input parameters. Transient events are output to a separate data structure to facilitate analysis.</p>
<p>After detection, transients are quantified by frequency, amplitude, half height rise time, half height fall time, half height width, and half height AUC. After detection and quantification, transients are binned into 5 minute (default) increments. The function <em>binTransients</em> identifies and adds the bin of each transient event to the <em>transientquantificiation</em> table. </p>
<p>Multiple plots are generated to visualize transient events and figures are saved to the <em>Figures</em> folder.</p>
<p>Whole session trace with all transient events:
<img alt="png" src="../img/exampleanalyses_4_SessionTransients_2_Saline.png" /></p>
<p>Individual bin traces with identified transients:
<img alt="png" src="../img/exampleanalyses_5_SessionBinTransients_2_Saline.png" /></p>
<p>Overlaid Transient Traces from the Whole Session:
<img alt="png" src="../img/exampleanalyses_6_SessionTransientsTraces.png" /></p>
<p>Overlaid Transient Traces by Bin:
<img alt="png" src="../img/exampleanalyses_7_BinTransientsTraces_2_Saline.png" /></p>
<p>To export the transient events for statistical analysis, the <em>summarizeTransients</em> and <em>summarizeBinTransients</em> functions are used to generate the session means of transient event quantification parameters.</p>
<h2 id="results">Results</h2>
<p>Overall, morphine administration significantly increased the frequency (figure panel C) and amplitude (figure panel E) of VTA DA activity transients relative to the saline control session. The increase in transient frequency and amplitude was observed approximately 10 minutes post-injection (figure panels D and F), and remained elevated relative to both pre-injection baseline and the matched saline control session through the end of the 60-minute post-injection recording.</p>
<p><img alt="png" src="../img/exampleanalyses_8_Results_FreqAmp.png" />
<strong>Transient Frequency and Amplitude Results.</strong> Example analysis of VTA DA transient frequency and amplitude after acute morphine administration. Representative examples of pre-injection baseline normalized traces from a single subject before and after <strong>A)</strong> an injection of saline (control) and <strong>B)</strong> an injection of morphine (10mg/kg). The vertical dashed line indicates time of injection. <strong>C)</strong> Mean transient frequency (transients per minute) across the entire session. <strong>D)</strong> Transient frequency binned in 5-minute time windows. <strong>E)</strong> Mean transient amplitude (z-score) across the session. <strong>F)</strong> Transient amplitude binned in 5-minute time windows. Data reflect automated transient detection using PASTa protocol defaults.</p>
<p>Additionally, relative to the matched control session, morphine increased VTA DA activity transient rise duration (figure panels A and B) and decreased VTA DA activity transient fall duration (figure panels C and D). Morphine increased the overall AUC of transients (figure panel E). These trends emerged approximately 10 minutes post-injection and returned to pre-treatment baseline and matched control session levels by the end of the post-injection recording period (figure panels B, D, and F).</p>
<p><img alt="png" src="../img/exampleanalyses_9_Results_Duration.png" />
<strong>Transient Duration Results</strong>. Example analysis of VTA DA transient event duration and AUC following acute saline (blue, control) and morphine (red) administration. <strong>A)</strong> Mean transient rise duration (milliseconds) across the full session. <strong>B)</strong> Transient rise duration binned in 5-minute time windows. <strong>C)</strong> Mean transient fall duration (milliseconds) across the full session. <strong>D)</strong> Transient fall duration binned in 5-minute time windows. <strong>E)</strong> Mean area under the curve (AUC) for transients. <strong>F)</strong> Transient AUC binned in 5-minute time windows. All duration and AUC metrics were calculated at half-height relative to the peak. Vertical dashed lines in B, D, and F indicate the time of saline or morphine injection.</p>
<h2 id="conclusion">Conclusion</h2>
<p>Together, this example analysis illustrates the complementary shifts in multiple aspects of transient dynamics, providing a more comprehensive evaluation of the effects of morphine on VTA DA activity. This example is provided to allow users to directly apply PASTa to a real data set and ensure that results are replicated across users of the toolbox.</p></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script src="../js/bootstrap.bundle.min.js"></script>
        <script>
            var base_url = "..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../js/base.js"></script>
        <script src="../search/main.js"></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <p>From here you can search these documents. Enter your search terms below.</p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results" data-no-results-text="No results found"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
